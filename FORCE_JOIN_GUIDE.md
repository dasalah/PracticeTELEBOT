# 🤖 سیستم جوین اجباری ربات انجمن هوش مصنوعی

## ویژگی‌های پیاده‌سازی شده

### 🔒 سیستم جوین اجباری پیشرفته
- بررسی عضویت کاربر در چنل قبل از هر پاسخ
- نمایش پیام زیبا با امکان "بررسی مجدد عضویت"
- معافیت ادمین‌ها از جوین اجباری
- سیستم تنظیمات قابل تغییر توسط سوپر ادمین

### 🎨 طراحی کاربری بهبود یافته
```
🔒 برای استفاده از ربات، ابتدا عضو چنل زیر شوید:

🤖 انجمن هوش مصنوعی دانشگاه سیستان و بلوچستان
@channel_username

💡 پس از عضویت، دکمه "بررسی مجدد عضویت" را بزنید.
```

### ⚙️ دستورات مدیریت (فقط سوپر ادمین)

#### `/set_force_channel @username`
تنظیم چنل اجباری
```
/set_force_channel @ai_society_usb
```

#### `/toggle_force_join`
فعال/غیرفعال کردن سیستم جوین اجباری

#### `/force_join_stats`
نمایش وضعیت فعلی سیستم جوین اجباری

### 🗄️ پایگاه داده تنظیمات

تنظیمات در جدول `settings` ذخیره می‌شوند:

| کلید | مقدار | توضیحات |
|------|--------|---------|
| `force_join_enabled` | `true`/`false` | فعال/غیرفعال بودن سیستم |
| `force_join_channel` | `@channel` | نام کاربری چنل اجباری |
| `super_admins` | `123,456` | لیست ID های سوپر ادمین‌ها |

### 🛡️ ویژگی‌های امنیتی

- **معافیت ادمین**: سوپر ادمین‌ها از جوین اجباری معاف هستند
- **مدیریت خطاها**: در صورت عدم دسترسی به چنل، دسترسی داده می‌شود
- **لاگ تغییرات**: تمام تنظیمات با timestamp ذخیره می‌شوند
- **دسترسی محدود**: فقط سوپر ادمین‌ها می‌توانند تنظیمات را تغییر دهند

### 🔄 تغییرات اعمال شده

#### در `userDB.py`:
- اضافه شدن مدل `Settings` برای ذخیره تنظیمات

#### در `func.py`:
- توابع مدیریت تنظیمات (`get_setting`, `set_setting`)
- middleware جوین اجباری (`check_force_join`)
- دستورات مدیریت (`handle_admin_commands`)
- بروزرسانی پیام‌ها با برندینگ انجمن هوش مصنوعی

#### در `main.py`:
- بروزرسانی handler ها برای استفاده از سیستم جدید
- اضافه شدن callback query handler برای دکمه "بررسی مجدد"
- پشتیبانی از دستورات مدیریتی

### 🧪 تست شده و تأیید شده

- ✅ بررسی عضویت کاربران
- ✅ معافیت سوپر ادمین‌ها
- ✅ مدیریت تنظیمات از طریق دستورات
- ✅ UI/UX بهبود یافته
- ✅ مدیریت خطاها
- ✅ callback query handling

### 🚀 نحوه استفاده

1. **برای فعال کردن جوین اجباری:**
   ```
   /set_force_channel @your_channel
   ```

2. **برای غیرفعال کردن:**
   ```
   /toggle_force_join
   ```

3. **برای مشاهده وضعیت:**
   ```
   /force_join_stats
   ```

سیستم به طور خودکار هنگام راه‌اندازی ربات با تنظیمات پیش‌فرض فعال می‌شود.